#!/usr/bin/env ruby

require "rubygems"
require "bundler/setup"
require_relative "../lib/nist_pubid"
require "thor"

class NistPubidCLI < Thor
  desc "report", "Create report for nist tech pubs database"
  def report
    puts "Changed | New PubID | Document ID | DOI | Title + subtitle"
    NistPubid::NistTechPubs.status.each do |row|
      puts "#{row[3] == row[0] ? ' -' : 'âœ…'} | #{row[3]} | #{row[0]} | #{row[1]}"\
           " | #{row[2]}"
    end
  end

  desc "convert", "Convert old document ID to new PubID"
  def convert(code)
    puts NistPubid::Document.parse(code).to_s(:short) unless code.empty?
  end
end

NistPubidCLI.start(ARGV)
